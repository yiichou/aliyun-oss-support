## ChangeLog - 阿里云附件存储
____________________

### 版本号: 3.4.1

修正日期：2022-09-25

1. 移除图片服务「自定义分隔符」中默认的 `@` #107

修正日期：2022-09-25

1. 升级 aliyun-oss-php-sdk
2. 移除 plugin-update-checker
3. 移除对 PHPMailer 的依赖

### 版本号: 3.3.0

修正日期：2021-11-24

1. 支持 Aliyun URL鉴权
2. 移除 repo 中的 vendor 目录，使用 composer 更新依赖
3. 兼容 Wordpress 5.4+
4. 增加 docker-compose.yml 方便测试
5. 新增 乌兰察布、河源、广州、成都、英国 大区 #124

### 版本号: 3.2.7

修正日期：2019-04-01

1. 新增『禁用主动上传文件到 OSS』 选项
2. 升级 plugin-update-checker 到 4.5.1

### 版本号: 3.2.6

修正日期：2019-03-27

1. 升级 aliyun-oss-php-sdk 到 2.3.0
2. 新增异常处理
3. 优化加载机制，尽可能的减小对系统资源的消耗（虽然本来就不占资源）

### 版本号: 3.2.5

1. 修正: 服务器本地不保留文件时，会导致 OSS 上对应的文件删不掉.
    若不開啟『图片服务』, 所生成的縮略圖仍然不會刪除.
2. 修正: 服务器本地不保留文件时，会导致无法安装插件.
3. 修正: 中文文件名會導致圖片服務連結錯誤.

### 版本号: 3.2.4

修正日期：2018-11-07

#### 修订内容：

1. 为 Exclude 项追加 Regexp Formatter, 避免不正确的表达式导致 Warning
2. 添加 Exclude 选项的翻译

### 版本号: 3.2.3

修正日期：2018-11-06

#### 修订内容：

1. 修复样式文件下载白屏 BUG #79
2. 新增 Exclude 模式，可以排除指定目录 #61 #80

### 版本号: 3.2.2

修正日期：2018-08-21

#### 修订内容：

1. 修复不能使用 OSS 根目录作为存储路径的 bug #70
2. 修复图片服务开启时, 缩略图依旧被上传的 bug #72
3. 新增插件自动更新功能
4. 为 Bucket Host 增加 fallback 值
5. 调整部分配置选项

### 版本号: 3.2.1

修正日期：2018-07-31

#### 修订内容：

1. 更换了缩略图、编辑图的上传机制, 使兼容范围更广
2. 修复了 OSS 上文件不能删除的 BUG
3. 修复设置页面的一处 BUG
4. 更新数据节点

### 版本号: 3.1.7

修正日期：2018-07-25

#### 修订内容：

1. 新增阿里云图片样式导出功能, 再也不用去阿里云后台一项一项的设置了
2. 修复了更换主题后, 在后台编辑之前的特色图片时可能会失败的 bug

### 版本号: 3.1.6

修正日期：2018-02-04

#### 修订内容：

1. 升级 aliyun-oss-php-sdk 到 2.3.0
2. 新增「图片保护」和「自定义分割符」选项
3. 增加三个自定义 filter/action, 方便在其他地方调用插件功能 

### 版本号: 3.1.5

修正日期：2017-10-11

#### 修订内容：

1. 启用「预设图片样式」情况下, 由于 OSS 服务的 bug, 不对 gif 做处理. [#43](/../../issues/43)

### 版本号: 3.1.4

修正日期：2017-03-30

#### 修订内容：

1. 支持 PHP 5.3+ (以前是 5.4+)

### 版本号: 3.1.3

修正日期：2017-03-26

#### 修订内容：

1. 新增 OSS 节点及翻译
2. 新增 VPC 网络支持

### 版本号: 3.1.2

修正日期：2017-02-12

#### 修订内容：

1. 修复启用 图片预设样式 时，原图无法显示的 bug

### 版本号: 3.1.1

修正日期：2017-01-14

#### 修订内容：

1. 不再使用 phar 打包

### 版本号: 3.1.0

修正日期：2017-01-09

#### 修订内容：

1. Aliyun OSS 图片服务规则升级,移除 img_host 参数
2. 追加一个隐藏参数: keep_settings -> 卸载不删除配置

### 版本号: 3.0.4

修正日期：2016-12-22

#### 修订内容：

1. 修正本地不保留文件时,同名文件覆盖. [#20](/../../issues/20)
2. 升级阿里云 OSS SDK 到 2.2.1
3. 添加自动打包脚本

### 版本号: 3.0.3

修正日期：2016-11-16

#### 修订内容：

1. 修复不保存本地文件条件下, medium_large 和 large 尺寸一样时上传 OSS 失败的 Bug. [#18](/../../issues/18) [#23](/../../issues/23)
2. 新增日本节点、法兰克福节点的支持

### 版本号：3.0.2

修正日期：2016-10-09

#### 修订内容：

1. 修复 [ISSUE #18](/../../issues/18)
____________________

### 版本号：3.0.1

修正日期：2016-10-06

#### 修订内容：

1. 修复 basename() 处理中文开头的文件名的 bug

____________________

### 版本号：3.0.0

修正日期：2016-10-03

#### 修订内容：

1. Fix a bug in image resize rule

____________________

### 版本号：3.0.0-beta2

修正日期：2016-09-24

#### 修订内容：

1. Fix bug [#13](/../../issues/13) 
____________________

### 版本号：3.0.0-beta

修正日期：2016-09-17

#### 修订内容：

1. Add new feature -- support watermark [#15](/../../issues/15) 

2. Add new feature -- save edited image [#13](/../../issues/13) 

3. Rebuild all codes under PSR-4 and use phar file to release.

4. Update Aliyun Oss SDK to the latest version.

5. Settings page supports both English and 中文.

____________________

### 版本号：2.4.1

修正日期：2016-07-12

#### 修订内容：

1. Fix the bug [#ISSUE 11](/../../issues/10) 

2. 启用图片服务时，不再需要预设图片处理方式，改为按 Wordpress 提供的尺寸自动处理

3. 修复上一个版本引入的一个语法错误

____________________

### 版本号：2.4.0

修正日期：2016-04-30

#### 修订内容：

1. 增加启用图片服务时，对 srcset 的支持（ 支持 wordpress 4.4+ ）

2. 修改数据节点的链接，原链接失效了

##### 感谢
[#9](/../../issues/9) （感谢 @hairui219 提供）

____________________

### 版本号：2.3.2

修正日期：2015-11-14

#### 修订内容：

1. 更新 SDK (2015-08-19 版)

2. 添加对数据节点设置的选项，考虑到以后可能还有各种节点，干脆留了个框自己填

3. 重新封装原来的 Aliyun_oss 对象，使其在使用上和 ACE 引擎内置的 Alibaba::Storge 类保持一致，现在 ACE 和其他环境通用一个版本 

4. 使用单例，之前脑子进屎了，没上传一个对象就要 new 一个对象，简直是浪费（可能是因为自己不需要上传缩略图，所以当时没 care，建议大家也使用 OSS 的图片服务，很 nice 的其实）

5. 解决设置本地不保存文件时，安装主题、插件失败，并被上传到 OSS 的 BUG

##### 感谢各位的提的 Issue，由于已经转到 ruby 开发了，php 很少接触了，不能保持维护，实在对不住

____________________

### 版本号：2.1.3

修正日期：2015-01-19

#### 修订内容：

1. 将设置界面的 Secret Key 隐藏，Secret Key 不再会被读取到客户端

2. 处理中文乱码问题

特别注意：处理中文问题的时候，我发现好像是 Aliyun SDK 的问题，细看了下源码，这个 SDK 写得有点怨念，对 Ali 的好感一下子掉了好多

具体修改了 sdk.class.php line 1290 ~ 1291

准备反馈给官方~

##### 感谢：网友 sjw(at)cnsjw.cn 的建议 和 风的涟漪协助测试

____________________

### 版本号：2.1.2

修正日期：2014-12-26

#### 修订内容：

修正在非当前月份文章中上传图片时，由于缩略图无法上传导致错误的 bug.

##### 感谢：网友 sjw(at)cnsjw.cn 协助修订

____________________

### 版本号：2.1.1

修正日期：2014-12-25

#### 修订内容：

处理 OSS 自定义存储 path 为空时出现的多斜线 Bug

##### 感谢：网友 sjw(at)cnsjw.cn 反馈

____________________

### 版本号：2.1

修正日期：2014-11-7

#### 修订内容：

在某些环境中，启用插件时提示

```
这个插件启用过程中产生了3个字符的**异常输出**。如果您遇到了……
```

原因为 sdk.class.php 这个文件编码问题，已修复

若仍有这个报错，请尝试转换文件编码与您的网站环境编码一致。

##### 感谢：网友 tang6818(at)foxmail.com 反馈

____________________

### 版本号：2.0

修正日期：2014-9-1

#### 修订内容：
1. 完全重构，优化代码
2. 支持 Aliyun OSS 的图片服务
3. 改变钩子嵌入机制，支持所有附件（以前的版本只上传图片，而且启用时其他附件完全不可用了，坑！！）
4. 添加卸载、不残留
5. 支持 Aliyun ACE （ 切换到 ACE 分支 ）


____________________

### 版本号：1.1

修正日期：2014-8-27

#### 修订项目：
1. 插件年久失修，其内部调用的 Aliyun OSS php SDK 已升级
2. WordPress 3.5以后 设置->多媒体 中没有路径配置，导致配置不便
3. Aliyun OSS 可以绑定自己的域名，插件中不能简单的设置

#### 修订内容：
1. 升级 Aliyun-OSS-SDK 到 1.1.6 版本 (2014-06-25更新)
2. 设置中可直接配置访问路径 Url，支持已绑定到 OSS 的独立域名
3. 支持自定义 OSS 上文件的存放目录 （不影响本地存储，中途若修改请手动移动 OSS 上文件，否则可能链接不到之前的资源）
4. 修正原插件 bug 若干
5. 优化代码 ~~（移除所有 Notice 级报错）~~
